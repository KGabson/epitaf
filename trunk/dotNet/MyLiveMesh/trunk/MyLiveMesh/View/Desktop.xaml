<UserControl
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:Data="clr-namespace:SLExtensions.Data;assembly=SLExtensions"
    xmlns:Views="clr-namespace:MyLiveMesh.View"
    xmlns:Controls="clr-namespace:SLExtensions.Controls;assembly=SLExtensions.Controls"
    xmlns:Input="clr-namespace:SLExtensions.Input;assembly=SLExtensions"

    xmlns:liquidPopup="clr-namespace:Liquid;assembly=Liquid.Popup"
    xmlns:liquid="clr-namespace:Liquid;assembly=Liquid" 
    
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:tools="clr-namespace:MyLiveMesh.Tools"
	mc:Ignorable="d"
	x:Class="MyLiveMesh.View.Desktop"
	d:DesignWidth="640" d:DesignHeight="480">
    <UserControl.Resources>
        <Data:ResourceSelector x:Key="resourceSelector">
            <Data:ResourceSelector.Resources>
                <ResourceDictionary>
                    <DataTemplate x:Key="FileViewModel">
                        <Views:File />
                    </DataTemplate>
                    <DataTemplate x:Key="ExplorerViewModel">
                        <Views:Explorer />
                    </DataTemplate>
                    <DataTemplate x:Key="FileUploaderViewModel">
                        <Views:FileUploader />
                    </DataTemplate>
                    <DataTemplate x:Key="ProgressDialogViewModel">
                        <Views:ProgressDialog />
                    </DataTemplate>
                </ResourceDictionary>
            </Data:ResourceSelector.Resources>
        </Data:ResourceSelector>
        <DataTemplate x:Key="controlTemplate">
            <ContentControl 
                Content="{Binding}"
                ContentTemplate="{Binding Converter={StaticResource resourceSelector}}" />
        </DataTemplate>
    </UserControl.Resources>
    
    <Grid 
        x:Name="LayoutRoot"
        Width="Auto"
        Height="Auto">
        <Canvas
            Width="Auto"
            Height="Auto">
            <ListBox 
                VerticalAlignment="Top"
                ItemsSource="{Binding Files}"
                ItemTemplate="{StaticResource controlTemplate}"
                Input:CommandService.Command="FileCommand" Canvas.Top="22" />
            <Button 
                Height="Auto"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top" 
                Width="116" 
                Content="Upload Files" 
                x:Name="FileUploadBtn"
                Input:CommandService.Command="FileUploaderCommand"/>
        </Canvas>
        <Canvas>
            <Canvas
            x:Name="explorerLayout"
            Width="Auto"
            Height="Auto" d:IsHidden="True">

                <ContentControl
                Content="{Binding Explorer}"
                ContentTemplate="{StaticResource controlTemplate}" />
            </Canvas>

            <Canvas
            x:Name="fileUploaderLayout"
            Height="480"
            Width="640"
            Margin="317,0,8,8"
            VerticalAlignment="Bottom">
                <ContentControl
                Content="{Binding ProgressDialog}"
                ContentTemplate="{StaticResource controlTemplate}" />
            </Canvas>
        </Canvas>
    </Grid>
</UserControl>